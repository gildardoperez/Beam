
<!-- MODAL -->
<!-- <a href="#openModal">Open Modal</a>

<div id="openModal" class="modalDialog">
	<div>
		<a href="#close" title="Close" class="close">X</a>
		<%= link_to "Login with Instagram", controller: "sessions", action: "connect", class: "login" %>
	</div>
</div> -->



<!-- <nav class="top-bar" data-topbar> -->
	<!-- Instagram user login/logout -->
 
<!--  NAV BAR -->
<nav class="top-bar" data-topbar>
  <ul class="title-area">
    <li>
	    <% if session[:access_token] %>
	      <h1 class="name"><%= image_tag current_user.avatar, id: "avatar" %>
				<%= current_user.username %></h1>
			<% end %>
    </li>
    
    <li class="toggle-topbar menu-icon"><a href="#">Menu</a></li>
  </ul>

  <section class="top-bar-section">

    <!-- Right Nav Section -->
    <ul class="right">
    	<% if session[:access_token] %>
    	<li><%= link_to "My Albums", albums_path, class: "albums" %></li>
    	<li><%= link_to "LOG OUT OF INSTAGRAM", {controller: "sessions", action: "disconnect"}, id: "disconnect", class: "login" %>
      </li>
      <% else %>
      <li><%= link_to "Login with Instagram", controller: "sessions", action: "connect", class: "login" %></li>
      <% end %>
      <li></li>
<!--       <li class="active"><a href="#">Right Button Active</a></li>
      <li class="has-dropdown">
        <a href="#">Right Button with Dropdown</a>
        <ul class="dropdown">
          <li><a href="#">First link in dropdown</a></li>

        </ul>
      </li> -->
    </ul>

    <!-- Left Nav Section -->
 <!--    <ul class="left">
      <li><a href="#">Left Nav Button</a></li>
    </ul> -->
  </section>
</nav>


	<header class="title"> 
    <p class="header">Beam</p>
  </header>

<!-- hashtag search bar -->

<div class="mainsearch">
	<%= form_tag searches_path, :method => "get" do %>
	<div class="searchbar"><%=text_field_tag :search, params[:search], :placeholder => "Search for a hashtag" %></div>
	<div class="searchbtn">
		<%= submit_tag "Search", :name => nil, class: "searchbutton" %>
	</div>
	<% end %>
</div>
	<!-- 
		need to handle bad requests for tags that are not viewable and revoked access separately
	INSTAGRAM LOGOUT - when user logouts of instagram from instagram.com our app needs to logout in the app and set session[:access_token] to nil
	-->



<!-- Display images from search result -->
<% if @instagram_results != [] && @instagram_results != nil %>
	<% if session[:access_token] %>
		<select id="select_album" class="albumselect">
			<option>Choose an album</option>
			<%= current_user.albums.each do |album| %>
				<option value="<%= album.id %>"><%= album.title %></option>
			<% end %>
		</select>
	<% end %>

	<div class="scrollbar">
	    <div class="handle"></div>
	</div>

	<div class="frame">
	    <ul class="slidee">
			<% @instagram_results.each do |result| %>
				<li>
					<%#= result.to_json %>
					<div class="image_info">
						<div class="image_header">
							<%= image_tag result.user.profile_picture, id: "avatar" %>
							<cite><a href="http://instagram.com/<%= result.user.username %>" target="_blank"><%= result.user.username %></a></cite>
							<%= distance_of_time_in_words(Time.now, Time.at(result.created_time.to_i),include_seconds: true) %> ago<br>
							<% if result.videos %>
								<a href="<%= result.videos.standard_resolution.url %>" target="_blank">Play Video</a>
							<% end %>
							<div class="add_to_album" data-image-ids="<%= result.id %>">Add</div>
						</div>
						<div class="image_footer">
							<%= truncate(result.caption.text, length: 100) if result.caption %>
						</div>
					</div>
					<%= image_tag result.images.standard_resolution.url %>
				</li>
			<% end %>
		</ul>
	</div>

<% end %>

<br><br>

<!-- hidden Instagram logout container -->
<div id="iframe_disconnect"></div>


<% if @instagram_results != [] && @instagram_results != nil %>
<div id="ctrbtns">
	<button class="fs" id="fullscreen">Fullscreen</button>
	<button class="fs" id="fullscreen_caption">Fullscreen w/captions</button>
</div><br /><br />
<% end %>

<!-- store next_url for jQuery -->
<script>
	var next_url = "<%= @next_url %>";
  
  // make search bar slideUp
  // $( document ).ready(function() {
    // $(".mainsearch").submit(function(event) {
    //   event.preventDefault();
    //   var form = $('form').serialize();
    //   $.get("<%= searches_path %>", form, null)

    //   console.log("function called")
    //   $(".title, searchbtn, searchbar").slideUp(400);
    // });
	
// // , showAppear
//     // allows slideshow to appear
//   //   function showAppear() {
//   //     console.log("working it!")
//   //     $("#ctrbtns").fadeIn(300, null);
//   //     console.log("working it!")
//   //     // $(".nav").fadeIn(300, null);
//   //   }
//   });
  // $( document ).ready(function() {
  // $(".fakeslider").fullScreen(true);
  // $(".fakeslider").fullScreen(false);
  // });
</script>






